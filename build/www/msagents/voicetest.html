<object id="AgentControl" width="0" height="0"
  classid="CLSID:D45FD31B-5C6E-11D1-9EC1-00C04FD7081F"
  codebase="#VERSION=2,0,0,0">
</object>

<object id="L&HTruVoice" width="0" height="0"
  classid="CLSID:B8F2846E-CE36-11D0-AC83-00C04FD97575"
  codebase="#VERSION=6,0,0,0">
</object>

<object id="MSSpeechRecognition" width="0" height="0"
  classid="CLSID:161FA781-A52C-11D0-8D7C-00A0C9034A7E"
  codebase="#VERSION=4,0,0,0">
</object>
<object classid="clsid:D45FD31B-5C6E-11D1-9EC1-00C04FD7081F" id="Agent" codebase="http://web.archive.org//web/20030819212750oe_/http://www.microsoft.com/MSAGENT/dev/code/TryMSAgent.asp#VERSION=2,0,0,0">
</object>
 
<object classid="clsid:B8F2846E-CE36-11D0-AC83-00C04FD97575" id="TruVoice" codebase="http://web.archive.org//web/20030819212750oe_/http://www.microsoft.com/MSAGENT/dev/code/TryMSAgent.asp#VERSION=6,0,0,0">
</object>
<script>var sBrowser, sUsrAg = navigator.userAgent; if (sUsrAg.indexOf("Chrome") > -1) { alert("This website will not work on Google Chrome! You have to use IETab or Internet Explorer.") }</script>
<link rel="stylesheet" type="text/css" href="/_static/css/banner-styles.css" />
<link rel="stylesheet" type="text/css" href="/_static/css/iconochive.css" /><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="KEYWORDS" content="try test sample HTML Web page code">
<meta name="DESCRIPTION" content="Simple test page to try Microsoft Agent and verify components are working successfully.">
<meta name="MS.LOCALE" content="EN-US"><link rel="apple-touch-icon" sizes="72x72" href="/msagents/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/msagents/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/msagents/favicon-16x16.png">
<link rel="manifest" href="/msagents/site.webmanifest">
<link rel="mask-icon" href="/msagents/afari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta http-equiv="X-UA-Compatible" content="IE=5">
<script>var sBrowser, sUsrAg = navigator.userAgent; if (sUsrAg.indexOf("Firefox") > -1) { alert("This website will not work on Firefox! You have to use IETab or Internet Explorer.") }</script>
<script language="VBScript" type="text/vbscript">
<!--
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'_/ Portions generated by MASH - Microsoft Agent Scripting Helper, version 7.5
'_/ by BellCraft Technologies, http://www.bellcraft.com/mash
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/

' * Character Objects
Dim Merlin

' * Variables
Dim UsedChars
Dim MerlinID
Dim BonziID
Dim PeedyID
Dim GenieID
Dim RobbyID
Dim RoverID
Dim MerlinACS
Dim BonziACS
Dim PeedyACS
Dim GenieACS
Dim RobbyACS
Dim RoverACS
Dim MerlinLoaded
Dim BonziLoaded
Dim PeedyLoaded
Dim GenieLoaded
Dim RobbyLoaded
Dim RoverLoaded
Dim HideReq
Dim Req

' * Initialize
UsedChars = "Merlin,Genie,Bonzi,Rover,Peedy,Robby"

' * Merlin
MerlinID = "Merlin"
MerlinACS = "merlin.acs"
MerlinLoaded = False

' * Bonzi
BonziID = "Bonzi"
BonziACS = "Bonzi.acs"
BonziLoaded = False

' * Peedy
PeedyID = "Peedy"
PeedyACS = "Peedy.acs"
PeedyLoaded = False

' * Genie
GenieID = "Genie"
GenieACS = "Genie.acs"
GenieLoaded = False

' * Robby
RobbyID = "Robby"
RobbyACS = "Robby.acs"
RobbyLoaded = False

' * Rover
RoverID = "Rover"
RoverACS = "Rover.acs"
RoverLoaded = False


Function IsAgentInstalled()
    ' Purpose:  Returns True if Agent 2.0 is installed, else False
    On Error Resume Next

    Dim AgentControl

    If ScriptEngineMajorVersion < 2 Then
        IsAgentInstalled = False
    Else
        Set AgentControl = CreateObject("Agent.Control.2")
        IsAgentInstalled = IsObject(AgentControl)
    End If
End Function

Sub Window_OnLoad
  ' Load the character
  AgentMain
End Sub


Sub AgentMain()
    On Error Resume Next

    If Not IsAgentInstalled() Then
        Exit Sub
    End If

    AgentControl.Connected = True

    MerlinLoaded = LoadLocalChar(MerlinID, MerlinACS)
    BonziLoaded = LoadLocalChar(BonziMerlinID, BonziACS)
    PeedyLoaded = LoadLocalChar(PeedyID, PeedyACS)
    GenieLoaded = LoadLocalChar(GenieID, GenieACS)
    RobbyLoaded = LoadLocalChar(RobbyID, RobbyACS)
    RobbyLoaded = LoadLocalChar(RobbyID, RoverACS)

    If Not MerlinLoaded Then
        ' Attempt to load default character
        MerlinLoaded = LoadLocalChar(MerlinID, "")
    End If

    If MerlinLoaded Then
        Call SetCharObj
    End If

    Call CheckLoadStatus
End Sub

Function LoadLocalChar(ByVal CharID, ByVal CharACS)
    ' Purpose:  Attempts to load the specified character
    ' Returns:  True if successful, False if not
    On Error Resume Next

    If CharACS = "" Then

    	AgentControl.Characters.Load CharID
    Else
    	AgentControl.Characters.Load CharID, CharACS
    End If

    If Err = 0 Then
        LoadLocalChar = True
        Exit Function
    End If
    LoadLocalChar = False
End Function

Sub SetCharObj()
    ' Purpose:  Sets the character reference and TTS Language ID
    On Error Resume Next

    Set Merlin = AgentControl.Characters(MerlinID)
    Merlin.LanguageID = &H409
End Sub

Sub CheckLoadStatus()
    ' Purpose:  Determines if required characters have been loaded.
    '           If not, issue request to load next character
    '           else run the AgentIntro routine

    Window.Status = ""
    Call AgentIntro
End Sub

Sub AgentControl_RequestComplete(ByVal RequestObject)
    ' Purpose:  Take action on completion or failure of requests
    On Error Resume Next

End Sub

Sub AgentControl_Click(ByVal CharacterID, ByVal Button, ByVal Shift, ByVal X, ByVal Y)

End Sub

Sub AgentControl_DblClick(ByVal CharacterID, ByVal Button, ByVal Shift, ByVal X, ByVal Y)
    ' Purpose:  Stop and Hide all characters on double-click
    On Error Resume Next

    Merlin.StopAll
    If Not MerlinID.HasOtherClients Then
        If Merlin.Visible Then
            Set HideReq = Merlin.Hide()
        Else
            AgentControl.Characters.Unload MerlinID
        End If
    End If
End Sub

Sub InitAgentCommands()
    ' Purpose:  Initialize the Commands menu
    On Error Resume Next 

    Merlin.Commands.Add "CONTROL", "Open Control Panel", "[Open] Control Panel"
    Merlin.Commands.Add "MYCOMPUTER", "My Computer", "[Open] My Computer"
    Merlin.Commands.Add "SPEECHCP", "Speech Control Panel", "[Open] Speech Control Panel"
    Merlin.Commands.Add "NOTEPAD", "Run Notepad", "[Please] [(Open|Run|Start|Launch)] Notepad [Please]"
    Merlin.Commands.Add "CHROME", "Run Google Chrome", "[Please] [(Open|Run|Start|Launch)] Google Chrome [Please]"
    Genie.Commands.Add "CONTROL3", "Open Control Panel", "[Open] Control Panel"
    Genie.Commands.Add "MYCOMPUTER3", "My Computer", "[Open] My Computer"
    Genie.Commands.Add "SPEECHCP3", "Speech Control Panel", "[Open] Speech Control Panel"
    Genie.Commands.Add "NOTEPAD3", "Run Notepad", "[Please] [(Open|Run|Start|Launch)] Notepad [Please]"
    Genie.Commands.Add "CHROME3", "Run Google Chrome", "[Please] [(Open|Run|Start|Launch)] Google Chrome [Please]"
    Bonzi.Commands.Add "CONTROL4", "Open Control Panel", "[Open] Control Panel"
    Bonzi.Commands.Add "MYCOMPUTER4", "My Computer", "[Open] My Computer"
    Bonzi.Commands.Add "SPEECHCP4", "Speech Control Panel", "[Open] Speech Control Panel"
    Bonzi.Commands.Add "NOTEPAD4", "Run Notepad", "[Please] [(Open|Run|Start|Launch)] Notepad [Please]"
    Bonzi.Commands.Add "CHROME4", "Run Google Chrome", "[Please] [(Open|Run|Start|Launch)] Google Chrome [Please]"
    Peedy.Commands.Add "CONTROL5", "Open Control Panel", "[Open] Control Panel"
    Peedy.Commands.Add "MYCOMPUTER5", "My Computer", "[Open] My Computer"
    Peedy.Commands.Add "SPEECHCP5", "Speech Control Panel", "[Open] Speech Control Panel"
    Peedy.Commands.Add "NOTEPAD5", "Run Notepad", "[Please] [(Open|Run|Start|Launch)] Notepad [Please]"
    Peedy.Commands.Add "CHROME5", "Run Google Chrome", "[Please] [(Open|Run|Start|Launch)] Google Chrome [Please]"

    Robby.Commands.Add "CONTROL6", "Open Control Panel", "[Open] Control Panel"
    Robby.Commands.Add "MYCOMPUTER6", "My Computer", "[Open] My Computer"
    Robby.Commands.Add "SPEECHCP6", "Speech Control Panel", "[Open] Speech Control Panel"
    Robby.Commands.Add "NOTEPAD6", "Run Notepad", "[Please] [(Open|Run|Start|Launch)] Notepad [Please]"
    Robby.Commands.Add "CHROME6", "Run Google Chrome", "[Please] [(Open|Run|Start|Launch)] Google Chrome [Please]"


    Rover.Commands.Add "CONTROL7", "Open Control Panel", "[Open] Control Panel"
    Rover.Commands.Add "MYCOMPUTER7", "My Computer", "[Open] My Computer"
    Rover.Commands.Add "SPEECHCP7", "Speech Control Panel", "[Open] Speech Control Panel"
    Rover.Commands.Add "NOTEPAD7", "Run Notepad", "[Please] [(Open|Run|Start|Launch)] Notepad [Please]"
    Rover.Commands.Add "CHROME7", "Run Google Chrome", "[Please] [(Open|Run|Start|Launch)] Google Chrome [Please]"

End Sub

Sub AgentControl_Command(ByVal UserInput)
    ' Purpose:  Determine Command that was selected either by menu or voice
    '           and run the applicable Command Script
    On Error Resume Next

    Dim BadConfidence
    BadConfidence = 10

    If (UserInput.Confidence <= -40) Then
        ' Bad Recognition
        Exit Sub
    ElseIf (UserInput.Alt1Name <> "") And Abs(Abs(UserInput.Alt1Confidence) - Abs(UserInput.Confidence)) < BadConfidence Then
        ' Bad Confidence - too close to another command
        Exit Sub
    ElseIf (UserInput.Alt2Name <> "") And Abs(Abs(UserInput.Alt2Confidence) - Abs(UserInput.Confidence)) < BadConfidence Then
        ' Bad Confidence - too close to another command
        Exit Sub
    Else ' High Confidence
        ' *** BEGIN MASH USER COMMANDS ***
        Select Case UserInput.Name
        Case "CONTROL"
            ShellEx "CONTROL.EXE"
        Case "MYCOMPUTER"
            ShellEx "Explorer.exe ::{20d04fe0-3aea-1069-a2d8-08002b30309d}"
        Case "SPEECHCP"
            ShellEx "rundll32.exe shell32.dll,Control_RunDLL speech.cpl,,1"
        Case "NOTEPAD"
            ShellEx "NOTEPAD.EXE"
        Case "CHROME"
            ShellEx "CHROME.EXE"
        Case "CONTROL2"
            ShellEx "CONTROL.EXE"
        Case "MYCOMPUTER2"
            ShellEx "Explorer.exe ::{20d04fe0-3aea-1069-a2d8-08002b30309d}"
        Case "SPEECHCP2"
            ShellEx "rundll32.exe shell32.dll,Control_RunDLL speech.cpl,,1"
        Case "NOTEPAD2"
            ShellEx "NOTEPAD.EXE"
        Case "CHROME2"
            ShellEx "CHROME.EXE"
        Case "CONTROL3"
            ShellEx "CONTROL.EXE"
        Case "MYCOMPUTER3"
            ShellEx "Explorer.exe ::{20d04fe0-3aea-1069-a2d8-08002b30309d}"
        Case "SPEECHCP3"
            ShellEx "rundll32.exe shell32.dll,Control_RunDLL speech.cpl,,1"
        Case "NOTEPAD3"
            ShellEx "NOTEPAD.EXE"
        Case "CHROME3"
            ShellEx "CHROME.EXE"
        Case "CONTROL4"
            ShellEx "CONTROL.EXE"
        Case "MYCOMPUTER4"
            ShellEx "Explorer.exe ::{20d04fe0-3aea-1069-a2d8-08002b30309d}"
        Case "SPEECHCP4"
            ShellEx "rundll32.exe shell32.dll,Control_RunDLL speech.cpl,,1"
        Case "NOTEPAD4"
            ShellEx "NOTEPAD.EXE"
        Case "CHROME4"
            ShellEx "CHROME.EXE"

        Case "CONTROL5"
            ShellEx "CONTROL.EXE"
        Case "MYCOMPUTER5"
            ShellEx "Explorer.exe ::{20d04fe0-3aea-1069-a2d8-08002b30309d}"
        Case "SPEECHCP5"
            ShellEx "rundll32.exe shell32.dll,Control_RunDLL speech.cpl,,1"
        Case "NOTEPAD5"
            ShellEx "NOTEPAD.EXE"
        Case "CHROME5"
            ShellEx "CHROME.EXE"

        Case "CONTROL6"
            ShellEx "CONTROL.EXE"
        Case "MYCOMPUTER6"
            ShellEx "Explorer.exe ::{20d04fe0-3aea-1069-a2d8-08002b30309d}"
        Case "SPEECHCP6"
            ShellEx "rundll32.exe shell32.dll,Control_RunDLL speech.cpl,,1"
        Case "NOTEPAD6"
            ShellEx "NOTEPAD.EXE"
        Case "CHROME6"
            ShellEx "CHROME.EXE"
        Case "CONTROL7"
            ShellEx "CONTROL.EXE"
        Case "MYCOMPUTER7"
            ShellEx "Explorer.exe ::{20d04fe0-3aea-1069-a2d8-08002b30309d}"
        Case "SPEECHCP7"
            ShellEx "rundll32.exe shell32.dll,Control_RunDLL speech.cpl,,1"
        Case "NOTEPAD7"
            ShellEx "NOTEPAD.EXE"
        Case "CHROME7"
            ShellEx "CHROME.EXE"
        End Select
        ' *** END MASH USER COMMANDS ***
    End If
End Sub

Sub AgentControl_Bookmark(ByVal BookmarkID)
    On Error Resume Next

End Sub

Sub AgentIntro()
    On Error Resume Next

    

    ' *** BEGIN MASH USER SCRIPT ***

    Merlin.TTSModeID = "{CA141FD0-AC7F-11D1-97A3-006008273002}"
    Merlin.Show
    Merlin.Play "Announce"
    Merlin.Speak "Welcome to the Speech Recognition System, from Seamus's Server."
    Merlin.Play "RestPose"
    Merlin.Speak "Powered by Microsoft Agent Scripting Helper. To help Microsoft Agent recognize your voice, you will need a Microphone, A Speech Recognition System, and Speech API."
	Merlin.Speak "If you don't have these programs. please download them from our downloads page."
    Merlin.Play "Write"
    Merlin.Speak "If you have completed Speech Recognition training, or you have setted up your binded key for talking to the Agent, You may now do your speech by pressing your binded speech key, shown in the Advanced Character Options, and such others."
    Merlin.Play "WriteReturn"
    Merlin.Play "Acknowledge"
    Merlin.Speak "I will stay here."

Call InitAgentCommands

    ' *** END MASH USER SCRIPT ***
End Sub
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
-->
</script>



